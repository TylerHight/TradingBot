The following code is used to analyze real-time and historical timeseries data to help make predictions about what the data will do in the future or what actions can be taken in response. However, it fits poorly into the larger context of the codebase because the methods perform the calculations for every given data point rather than only the most recent one, meaning that, if these methods were called in a simulation or during a real-time analysis, all but the most recent calculation would be redundant. To fix this, rewrite the methods 'calculateMovingAverage' and 'calculateEMA' to perform the minimal calculations necessary to obtain the output for the most recent data point in the provided timeseries data (the output to these functions should be a double instead of a List of doubles). If there is not yet enough data to perform a calculation, return Double.NaN.